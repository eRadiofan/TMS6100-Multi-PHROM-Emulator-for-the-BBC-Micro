   10 REM >SPHRASE
   20
   30 DIM CODE% 190
   40 DIM DTA1% 5
   50 DIM PPTR% 4
   60 DIM IADR% 4
   70 DIM RDAT% 1
   80 FOR N=0 TO 2 STEP 2
   90   P%=CODE%
  100   [OPTN
  110   .REVERSE STA &80
  120   ROL &80:ROR A
  130   ROL &80:ROR A
  140   ROL &80:ROR A
  150   ROL &80:ROR A
  160   ROL &80:ROR A
  170   ROL &80:ROR A
  180   ROL &80:ROR A
  190   ROL &80:ROR A
  200   RTS
  210   .SETADDR LDA #&9F
  220   LDX #0
  230   .LOOP1
  240   LDY DTA1%,X
  250   JSR &FFF4
  260   INX:CPX #5
  270   BNE LOOP1
  280   RTS
  290   .CMD LDA#&9F
  300   JSR &FFF4
  310   RTS
  320   .RDP LDA #&9F
  330   LDY #&10
  340   JSR &FFF4
  350   LDA #&9E
  360   JSR &FFF4
  370   STY RDAT%
  380   RTS
  390   .TIDX JSR RDP
  400   TYA:CLC
  410   ADC IADR%
  420   BCC TIDX2
  430   INC IADR%+1
  440   CLC
  450   .TIDX2 ADC #6
  460   STA IADR%
  470   LDA IADR%+1
  480   ADC #0
  490   STA IADR%+1
  500   .IADDR LDA IADR%
  510   TAY
  520   AND #&F
  530   ORA #&40
  540   STA DTA1%
  550   TYA
  560   LSR A:LSR A:LSR A:LSR A
  570   ORA #&40
  580   STA DTA1%+1
  590   LDA IADR%+1
  600   TAY
  610   AND #&F
  620   ORA #&40
  630   STA DTA1%+2
  640   TYA
  650   LSR A:LSR A:LSR A:LSR A
  660   ORA #&40
  670   STA DTA1%+3
  680   LDA #&40
  690   STA DTA1%+4
  700   LDA IADR%
  710   CLC:ADC #3
  720   STA IADR%
  730   LDA IADR%+1
  740   ADC #0
  750   STA IADR%+1
  760   JSR SETADDR
  770   JSR RDP:STY PPTR%+1
  780   JSR RDP:STY PPTR%
  790   JMP RDP
  800   ]
  810 NEXT
  820
  830 PROCPHRASE_I(15,208)
  840 PROCSETADDR(0,0)
  850 RTPE%=FNREAD
  860 IF RTPE%=&AA THEN PRINT "PHROM ID (0,4,15)"; ELSE PRINT "PHROM ID (0,2,4,15)";
  870 INPUT RN%
  880 BN% = 1
  890 IF RN% = 2 THEN BN%=0:MAX%=148:PROCINITDATA
  900 IF RN% = 0 AND RTPE%=&AA THEN PROCTI99INDEX:BN%=0:MAX%=373
  910 IF RN% = 0 AND RTPE% <> &AA THEN MAX%=206
  920 IF RN% = 15 THEN BN% = 32:MAX% = 260:PRINT "Phrase Acorn = 129"
  930 IF RN% = 4 THEN MAX% = 35
  940 LAST% = 1
  950 PRINT"<RETURN> = Previous, -1 = All"
  960 REPEAT
  970   PRINT "Phrase number (1-";MAX%;")";
  980   INPUT PN%
  990   IF (PN% = 0) THEN PN% = LAST%
 1000   IF PN% = -1 THEN PROCALL(RN%,BN%,MAX%-1) ELSE PROCPHRASE(RN%,BN%+PN%-1)
 1010   LAST% = PN%
 1020 UNTIL 0
 1030
 1040 DEFPROCPHRASE(RN%,PN%)
 1050 AN% = -1
 1060 IF RTPE%=&AA AND RN%=0 THEN AN%=IDX99%(PN%)
 1070 IF RN%=2 THEN AN%=IDXDATA%(PN%)
 1080 REM PRINT PN%, ~AN%
 1090 IF (AN% > &4000) THEN RN%=RN%+1:AN%=AN%-&4000
 1100 IF AN% >= 0 THEN PROCSETADDR(RN%,AN%):PROCSPEAK ELSE PROCPHRASE_D(RN%,PN%)
 1110 ENDPROC
 1120
 1130 DEF PROCALL(RN%,BN%,MAX%)
 1140 FOR I% = 0 TO MAX%
 1150   PRINT "Phrase ";I%+1
 1160   PROCPHRASE(RN%,BN%+I%)
 1170   FOR J%=0 TO 4000:NEXT
 1180 NEXT
 1190 ENDPROC
 1200
 1210 DEF FNREVERSE(A%)
 1220 =USR(REVERSE) AND &FF
 1230
 1240 DEF FNREAD
 1250 CALL RDP
 1260 =?RDAT%
 1270
 1280 DEF PROCSETADDR(RN%,PA%)
 1290 DTA1%?0=&40+(PA% AND &000F)
 1300 DTA1%?1=&40+((PA% AND &00F0) DIV 16)
 1310 DTA1%?2=&40+((PA% AND &0F00) DIV 256)
 1320 DTA1%?3=&40+(RN% AND 3)*4+((PA% AND &3000) DIV &1000)
 1330 DTA1%?4=&40+(RN% AND 12)/4
 1340 CALL SETADDR
 1350 ENDPROC
 1360
 1370 DEF PROCSPEAK
 1380 Y%=&50:CALL CMD
 1390 ENDPROC
 1400
 1410 DEF PROCPHRASE_D(RN%,PN%)
 1420 PA%=2 * PN%
 1430 PROCSETADDR(RN%,PA%)
 1440 LO% = FNREVERSE(FNREAD)
 1450 HI% = FNREVERSE(FNREAD)
 1460 PA% = LO% + 256*HI%
 1470 PROCSETADDR(RN%,PA%)
 1480 PROCSPEAK
 1490 ENDPROC
 1500
 1510 DEF PROCPHRASE_I(RN%,PN%)
 1520 PA%=2 * PN%
 1530 PROCSETADDR(RN%,PA%)
 1540 Y%=&30
 1550 CALL CMD
 1560 PROCSPEAK
 1570 ENDPROC
 1580
 1590 DEF PROCTI99INDEX
 1600 DIM IDX99%(373)
 1610 !IADR%=1
 1620 !PPTR%=0
 1630 FOR I% = 0 TO 373
 1640   CALL TIDX
 1650   IDX99%(I%)=!PPTR%
 1660 NEXT
 1670 ENDPROC
 1680
 1690 DEF PROCINITDATA
 1700 DIM IDXDATA%(148)
 1710 IDX%=0
 1720 REPEAT
 1730   READ Y$
 1740   IDXDATA%(IDX%)=EVAL("&"+Y$)
 1750   IDX%=IDX%+1
 1760 UNTIL IDX%=148
 1770 ENDPROC
 1780 DATA 0, 64, BC, 11E, 171, 1B3, 248, 280
 1790 DATA 2F6, 356, 3BC, 409, 44C, 48E, 52A, 587
 1800 DATA 5C9, 610, 670, 706, 77D, 7FB, 86E, 8C7
 1810 DATA 93B, 984, A38, ACF, B74, C07, C78, D0B
 1820 DATA DD2, E50, E8D, E96, F13, F6E, FE6, 103D
 1830 DATA 1098, 10DA, 115E, 11C2, 1221, 1287, 130A, 13B9
 1840 DATA 1420, 14A5, 1511, 1579, 15FD, 167E, 16EB, 178E
 1850 DATA 1800, 1868, 18D6, 193C, 19AA, 1A07, 1A5F, 1B09
 1860 DATA 1B52, 1BBF, 1BF6, 1C63, 1CED, 1D27, 1D7E, 1DDA
 1870 DATA 1E31, 1E91, 1EEA, 1FA3, 200F, 205A, 20B6, 2102
 1880 DATA 2181, 21EE, 225B, 22F3, 2336, 2381, 23CE, 2435
 1890 DATA 248A, 24F9, 256D, 25A8, 2639, 26A4, 26F9, 277C
 1900 DATA 2806, 28A0, 28FA, 2976, 29BF, 2A25, 2A78, 2AC6
 1910 DATA 2B26, 2B93, 2C16, 2C6E, 2CD0, 2D28, 2D97, 2E13
 1920 DATA 2E90, 2F0A, 2F51, 2FA8, 2FE2, 3068, 30C3, 3119
 1930 DATA 3148, 31B6, 320C, 3273, 32E5, 3364, 33C9, 3435
 1940 DATA 34AE, 350F, 356F, 35C9, 3659, 36E2, 379A, 3807
 1950 DATA 3881, 3902, 3999, 3A2F, 3AA9, 3B09, 3B45, 3BBB
 1960 DATA 3C41, 3C74, 3C95, 3D13
