   10 REM >SPHRASE
   20
   30 DIM CODE% 190
   40 DIM DTA1% 5
   50 DIM PPTR% 4
   60 DIM IADR% 4
   70 DIM RDAT% 1
   80 FOR N=0 TO 2 STEP 2
   90   P%=CODE%
  100   [OPTN
  110   .REVERSE STA &80
  120   ROL &80:ROR A
  130   ROL &80:ROR A
  140   ROL &80:ROR A
  150   ROL &80:ROR A
  160   ROL &80:ROR A
  170   ROL &80:ROR A
  180   ROL &80:ROR A
  190   ROL &80:ROR A
  200   RTS
  210   .SETADDR LDA #&9F
  220   LDX #0
  230   .LOOP1
  240   LDY DTA1%,X
  250   JSR &FFF4
  260   INX:CPX #5
  270   BNE LOOP1
  280   RTS
  290   .CMD LDA#&9F
  300   JSR &FFF4
  310   RTS
  320   .RDP LDA #&9F
  330   LDY #&10
  340   JSR &FFF4
  350   LDA #&9E
  360   JSR &FFF4
  370   STY RDAT%
  380   RTS
  390   .TIDX JSR RDP
  400   TYA:CLC
  410   ADC IADR%
  420   BCC TIDX2
  430   INC IADR%+1
  440   CLC
  450   .TIDX2 ADC #6
  460   STA IADR%
  470   LDA IADR%+1
  480   ADC #0
  490   STA IADR%+1
  500   .IADDR LDA IADR%
  510   TAY
  520   AND #&F
  530   ORA #&40
  540   STA DTA1%
  550   TYA
  560   LSR A:LSR A:LSR A:LSR A
  570   ORA #&40
  580   STA DTA1%+1
  590   LDA IADR%+1
  600   TAY
  610   AND #&F
  620   ORA #&40
  630   STA DTA1%+2
  640   TYA
  650   LSR A:LSR A:LSR A:LSR A
  660   ORA #&40
  670   STA DTA1%+3
  680   LDA #&40
  690   STA DTA1%+4
  700   LDA IADR%
  710   CLC:ADC #3
  720   STA IADR%
  730   LDA IADR%+1
  740   ADC #0
  750   STA IADR%+1
  760   JSR SETADDR
  770   JSR RDP:STY PPTR%+1
  780   JSR RDP:STY PPTR%
  790   JMP RDP
  800   ]
  810 NEXT
  820
  830 PROCPHRASE_I(15,208)
  840 PROCSETADDR(0,0)
  850 RTPE%=FNREAD
  860 PROCSETADDR(10,1)
  870 STW%=FNREAD
  880
  890 IF RTPE%=&AA THEN PRINT "PHROM ID (0,4,15)";
  900 IF RTPE%<>&AA AND STW%=232 THEN PRINT "PHROM ID (0,2,4,10,15)";
  910 IF RTPE%<>&AA AND STW%<>232 THEN PRINT "PHROM ID (0,2,4,15)";
  920 INPUT RN%
  930 BN% = 1
  940 IF RN% = 2 THEN BN%=0:MAX%=148:PROCINITDATA
  950 IF RN% = 0 AND RTPE%=&AA THEN PROCTI99INDEX:BN%=0:MAX%=373
  960 IF RN% = 0 AND RTPE% <> &AA THEN MAX%=206
  970 IF RN% = 10 MAX%=23
  980 IF RN% = 15 THEN BN% = 32:MAX% = 260:PRINT "Phrase Acorn = 129"
  990 IF RN% = 4 THEN MAX% = 35
 1000 LAST% = 1
 1010 PRINT"<RETURN> = Previous, -1 = All"
 1020 REPEAT
 1030   PRINT "Phrase number (1-";MAX%;")";
 1040   INPUT PN%
 1050   IF (PN% = 0) THEN PN% = LAST%
 1060   IF PN% = -1 THEN PROCALL(RN%,BN%,MAX%-1) ELSE PROCPHRASE(RN%,BN%+PN%-1)
 1070   LAST% = PN%
 1080 UNTIL 0
 1090
 1100 DEFPROCPHRASE(RN%,PN%)
 1110 AN% = -1
 1120 IF RTPE%=&AA AND RN%=0 THEN AN%=IDX99%(PN%)
 1130 IF RN%=2 THEN AN%=IDXDATA%(PN%)
 1140 REM PRINT PN%, ~AN%
 1150 IF (AN% > &4000) THEN RN%=RN%+1:AN%=AN%-&4000
 1160 IF AN% >= 0 THEN PROCSETADDR(RN%,AN%):PROCSPEAK ELSE PROCPHRASE_D(RN%,PN%)
 1170 ENDPROC
 1180
 1190 DEF PROCALL(RN%,BN%,MAX%)
 1200 FOR I% = 0 TO MAX%
 1210   PRINT "Phrase ";I%+1
 1220   PROCPHRASE(RN%,BN%+I%)
 1230   FOR J%=0 TO 4000:NEXT
 1240 NEXT
 1250 ENDPROC
 1260
 1270 DEF FNREVERSE(A%)
 1280 =USR(REVERSE) AND &FF
 1290
 1300 DEF FNREAD
 1310 CALL RDP
 1320 =?RDAT%
 1330
 1340 DEF PROCSETADDR(RN%,PA%)
 1350 DTA1%?0=&40+(PA% AND &000F)
 1360 DTA1%?1=&40+((PA% AND &00F0) DIV 16)
 1370 DTA1%?2=&40+((PA% AND &0F00) DIV 256)
 1380 DTA1%?3=&40+(RN% AND 3)*4+((PA% AND &3000) DIV &1000)
 1390 DTA1%?4=&40+(RN% AND 12)/4
 1400 CALL SETADDR
 1410 ENDPROC
 1420
 1430 DEF PROCSPEAK
 1440 Y%=&50:CALL CMD
 1450 ENDPROC
 1460
 1470 DEF PROCPHRASE_D(RN%,PN%)
 1480 PA%=2 * PN%
 1490 PROCSETADDR(RN%,PA%)
 1500 LO% = FNREVERSE(FNREAD)
 1510 HI% = FNREVERSE(FNREAD)
 1520 PA% = LO% + 256*HI%
 1530 PROCSETADDR(RN%,PA%)
 1540 PROCSPEAK
 1550 ENDPROC
 1560
 1570 DEF PROCPHRASE_I(RN%,PN%)
 1580 PA%=2 * PN%
 1590 PROCSETADDR(RN%,PA%)
 1600 Y%=&30
 1610 CALL CMD
 1620 PROCSPEAK
 1630 ENDPROC
 1640
 1650 DEF PROCTI99INDEX
 1660 DIM IDX99%(373)
 1670 !IADR%=1
 1680 !PPTR%=0
 1690 FOR I% = 0 TO 373
 1700   CALL TIDX
 1710   IDX99%(I%)=!PPTR%
 1720 NEXT
 1730 ENDPROC
 1740
 1750 DEF PROCINITDATA
 1760 DIM IDXDATA%(148)
 1770 IDX%=0
 1780 REPEAT
 1790   READ Y$
 1800   IDXDATA%(IDX%)=EVAL("&"+Y$)
 1810   IDX%=IDX%+1
 1820 UNTIL IDX%=148
 1830 ENDPROC
 1840 DATA 0, 64, BC, 11E, 171, 1B3, 248, 280
 1850 DATA 2F6, 356, 3BC, 409, 44C, 48E, 52A, 587
 1860 DATA 5C9, 610, 670, 706, 77D, 7FB, 86E, 8C7
 1870 DATA 93B, 984, A38, ACF, B74, C07, C78, D0B
 1880 DATA DD2, E50, E8D, E96, F13, F6E, FE6, 103D
 1890 DATA 1098, 10DA, 115E, 11C2, 1221, 1287, 130A, 13B9
 1900 DATA 1420, 14A5, 1511, 1579, 15FD, 167E, 16EB, 178E
 1910 DATA 1800, 1868, 18D6, 193C, 19AA, 1A07, 1A5F, 1B09
 1920 DATA 1B52, 1BBF, 1BF6, 1C63, 1CED, 1D27, 1D7E, 1DDA
 1930 DATA 1E31, 1E91, 1EEA, 1FA3, 200F, 205A, 20B6, 2102
 1940 DATA 2181, 21EE, 225B, 22F3, 2336, 2381, 23CE, 2435
 1950 DATA 248A, 24F9, 256D, 25A8, 2639, 26A4, 26F9, 277C
 1960 DATA 2806, 28A0, 28FA, 2976, 29BF, 2A25, 2A78, 2AC6
 1970 DATA 2B26, 2B93, 2C16, 2C6E, 2CD0, 2D28, 2D97, 2E13
 1980 DATA 2E90, 2F0A, 2F51, 2FA8, 2FE2, 3068, 30C3, 3119
 1990 DATA 3148, 31B6, 320C, 3273, 32E5, 3364, 33C9, 3435
 2000 DATA 34AE, 350F, 356F, 35C9, 3659, 36E2, 379A, 3807
 2010 DATA 3881, 3902, 3999, 3A2F, 3AA9, 3B09, 3B45, 3BBB
 2020 DATA 3C41, 3C74, 3C95, 3D13
